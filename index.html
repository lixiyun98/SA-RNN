<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>MIMO Self-attentive RNN Beamformer for Multi-speaker Speech Separation</title>
</head>

<body>
<h2 id="MIMO Self-attentive RNN Beamformer for Multi-speaker Speech Separation">MIMO Self-attentive RNN Beamformer for Multi-speaker Speech Separation</h2>
<p>Submitted to Interspeech2021,   <strong>Xiyun Li</strong> (lixiyun2020@ia.ac.cn), Yong Xu, Meng Yu, Shi-xiong Zhang, Jiaming Xu, Bo Xu, Dong Yu
<p> </p>
<br><strong>Institute of Automation, Chinese Academy of Sciences (CASIA), Beijing, China</strong>
<br><strong>School of Future Technology, University of Chinese Academy of Sciences, Beijing, China</strong>
<br><strong>Tencent AI Lab, Bellevue, USA</strong>
</p>
    
<p><img src="system_overview.png" width="900"/></p>
<p> Purely neural network based speech separation systems often cause nonlinear distortion on the separated speech, which is harmful for many automatic speech recognition (ASR) systems [1]. 
The minimum variance distortionless response (MVDR) beamformer can be used to minimize the distortion, yet conventional MVDR approaches still result in high level of residual noise [2,3].
    In this study, we propose a self-attentive RNN (denoted as SA-RNN) beamformer framework to further improve our previous RNN-based beamformer [7,8] by leveraging on the powerful modeling capability of self-attention.
    Temporal-spatial self-attention module is proposed to better learn the beamforming weights from the speech and noise spatial covariance matrices.
    Our model can greatly remove the residual noise while ensuring the distortionless of the target speech. Our system outperforms prior arts in many objective evaluation metrics as well as the ASR accuracy. </p>

<p> A Mandarin audio-visual dataset [3,4,6,7,8] is adopted for this study, the word error rate (WER) is measured with a Tencent commercial mandarin speech recognition API [9].</p>
    
<p><strong> Systems evaluated: </strong></p>
<p>1. MIMO Conv-TasNet with STFT: A Conv-TasNet variant [5,6]</p>
<p>2. MIMO MVDR: An MVDR system [3]</p>
<p>3. MIMO Generalized RNN(GRNN) beamformer [8]</p>
<p>4. Proposed MIMO RNN+temporal SA beamformer</p>
<p>5. Proposed MIMO RNN+spatial SA beamformer</p>
<p>6. Proposed MIMO temporal-spatial SA beamformer</p>
<p>7. <strong>Proposed RNN+temporal-spatial SA beamformer</strong> </p>
 
<p>&nbsp;</p>

<p><strong>Wearing a headphone is strongly recommended.</strong></p>
<p>Purely NN systems [4,5,6] can greatly remove the residual noise, but cause nonlinear distortion (e.g., blackhole on spectrogram).</p>
<p>Conventional MVDR systems [2,3] can ensure the distortionless of the target speech, while result in high level of residual noise.</p>
<p>Our proposed <strong>RNN+temporal-spatial SA beamformer systems</strong> can ensure the distortionless of the target speech while also eliminating the residual noise.</p>
    
<!--<p><strong>Demo 1: Simulated 1-speaker noisy mixture for target speech separation</strong> [Sorry that all the demos are recorded in Mandarin Chinese.]</p>-->
<!--<p>-->
<!--<img src="1spk/mix.png" width="305" height="125" /> -->
<!--<img src="1spk/ref.png" width="300" height="125" /> -->
<!--<img src="1spk/NNbaseline.png" width="308" height="125" /> -->
<!--<img src="1spk/NN3x3.png" width="305" height="125" /></p>-->
<!--<table width="1068" border="1">-->
<!--  <tr>-->
<!--    <td width="255">Mix (1 speaker + non-stationary additive noise) -->
<!--        <audio-->
<!--        controls-->
<!--        src="1spk/mix.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--        </audio>-->
<!--    </td>-->
<!--    <td width="255">Reverberant clean (reference) -->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/ref.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>    -->
<!--    </td>-->
<!--    <td width="255">NN with cRM -->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/NNbaseline.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>-->
<!--    </td>-->
<!--    <td width="255">NN with cRF -->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/NN3x3.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>-->
<!--    </td>-->
<!--  </tr>-->
<!--</table>-->

<!--<p>-->
<!--<img src="1spk/MVDR.png" width="305" height="125" /> -->
<!--<img src="1spk/MVDR3X3.png" width="305" height="125" />-->
<!--<img src="1spk/2tapMVDR.png" width="305" height="125" /> -->
<!--<img src="1spk/2tapMVDR3X3.png" width="300" height="125" />-->
<!--</p>-->
<!--<table width="775" border="1">-->
<!--  <tr>-->
<!--    <td width="305">MVDR with cRM -->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/MVDR.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>-->
<!--    </td>-->
<!--    <td width="305">MVDR with cRF  -->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/MVDR3X3.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>-->
<!--    </td>-->
<!--    <td width="275">Multi-tap MVDR with cRM (2-tap: [t-1,t])-->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/2tapMVDR.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>    -->
<!--    </td>-->
<!--    <td width="275">Multi-tap MVDR with cRF (2-tap: [t-1,t])-->
<!--    <audio-->
<!--        controls-->
<!--        src="1spk/2tapMVDR3X3.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>    -->
<!--    </td>-->
<!--  </tr>-->
<!--</table>-->
<!--<p>-->
<!--<img src="1spk/RD-MVDR.png" width="300" height="125" />  -->
<!--</p>-->
<!--<table width="255" border="1">-->
<!--  <tr>-->
<!--  <td width="255"><strong>Proposed ADL-MVDR with cRF </strong>-->
<!--      <audio-->
<!--        controls-->
<!--        src="1spk/RD-MVDR.wav">-->
<!--            Your browser does not support the-->
<!--            <code>audio</code> element.-->
<!--    </audio>-->
<!--  </td>-->
<!--  </tr>-->
<!--</table>   -->
<!--    -->

<!--<p>&nbsp;</p>-->

    

<p><strong>Demo1: Simulated 2-speaker noisy mixture for target speech separation </strong> <strong>separation</strong></p>
<p>
<img src="2spk/mix/mix.png" width="305" height="125" />
<img src="2spk/ref/ref1.png" width="305" height="125" />
<img src="2spk/ref/ref2.png" width="305" height="125" />
<table width="915" border="1">
  <tr>
    <td width="305">Mix (2 speakers + non-stationary additive noise)
        <audio
        controls
        src="2spk/mix/mix.wav">
            Your browser does not support the
            <code>audio</code> element.
        </audio>
    </td>
    <td width="305">Reverberant clean of speaker1 (reference)
    <audio
        controls
        src="2spk/ref/ref1.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>    
    </td>
      <td width="305">Reverberant clean of speaker2 (reference)
    <audio
        controls
        src="2spk/ref/ref2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
  </tr>
</table>

<p>
<img src="2spk/enh/mvdr-1.png" width="305" height="125" />
<img src="2spk/enh/mvdr-2.png" width="305" height="125" />
<img src="2spk/enh/tasnet-1.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>
    <td width="305">MIMO MVDR for speaker1
    <audio
        controls
        src="2spk/enh/mvdr.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
    <td width="305">MIMO MVDR for speaker2
    <audio
        controls
        src="2spk/enh/mvdr-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
    <td width="305">MIMO TasNet for speaker1
    <audio
        controls
        src="2spk/enh/tasnet.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>    
    </td>
  </tr>
</table>

<p>
<img src="2spk/enh/tasnet-2.png" width="305" height="125" />
    <img src="2spk/enh/grnn.png" width="305" height="125" />
<img src="2spk/enh/grnn-2.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>
  <td width="305">MIMO TasNet for speaker2
    <audio
        controls
        src="2spk/enh/tasnet-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
      <td width="305">MIMO Generalized RNN beamformer for speaker1
    <audio
        controls
        src="2spk/enh/grnn.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
      <td width="305">MIMO Generalized RNN beamformer for speaker2
    <audio
        controls
        src="2spk/enh/grnn-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
  </tr>
</table>
<p>
<img src="2spk/enh/sarnn.png" width="305" height="125" />
<img src="2spk/enh/sarnn-2.png" width="305" height="125" />
</p>
<table width="610" border="1">
  <tr>
      <td width="305"><strong>MIMO RNN+temporal-spatial SA beamformer for speaker1
          </strong>
    <audio
        controls
        src="2spk/enh/temporal spatial sa-rnn.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
      <td width="305"><strong>MIMO RNN+temporal-spatial SA beamformer for speaker2
    </strong>
          <audio
        controls
        src="2spk/enh/temporal spatial sa-rnn2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
  </tr>
</table>
<p>&nbsp;</p>

    
    
<p><strong>Demo 2: Simulated 3-speaker noisy mixture for target speech separation </strong></p>
<p>
<img src="3spk/mix/mix.png" width="305" height="125" />
<img src="3spk/ref/ref.png" width="305" height="125" />
<img src="3spk/ref/ref2.png" width="305" height="125" />
    <img src="3spk/ref/ref3.png" width="305" height="125" />
</p>
<table width="1220" border="1">
  <tr>
    <td width="305">Mix (3 speakers + non-stationary additive noise)
        <audio
        controls
        src="3spk/mix/mix.wav">
            Your browser does not support the
            <code>audio</code> element.
        </audio>
    </td>
    <td width="305">Reverberant clean (reference) of speaker1
    <audio
        controls
        src="3spk/ref/ref.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>    
    </td>
    <td width="305">Reverberant clean (reference) of speaker2
    <audio
        controls
        src="3spk/ref/ref2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
      <td width="305">Reverberant clean (reference) of speaker3
    <audio
        controls
        src="3spk/ref/ref3.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
  </tr>
</table>
<p>
<img src="3spk/enh/mvdr.png" width="305" height="125" />
<img src="3spk/enh/mvdr-2.png" width="305" height="125" />
    <img src="3spk/enh/mvdr-3.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>

    <td width="305">MIMO MVDR for speaker1
    <audio
        controls
        src="3spk/enh/mvdr.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
    </td>
    <td width="305">MIMO MVDR for speaker2
    <audio
        controls
        src="3spk/enh/mvdr-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>    
    </td>
      <td width="305">MIMO MVDR for speaker3
      <audio
        controls
        src="3spk/enh/mvdr-3.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
  </tr>
</table>

<p>
    <img src="3spk/enh/tasnet.png" width="305" height="125" />
<img src="3spk/enh/tasnet-2.png" width="305" height="125" />
    <img src="3spk/enh/tasnet-3.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>

      <td width="305">MIMO Conv-TasNet for speaker1
      <audio
        controls
        src="3spk/enh/tasnet.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305">MIMO Conv-TasNet for speaker2
      <audio
        controls
        src="3spk/enh/tasnet-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305">MIMO Conv-TasNet for speaker3
      <audio
        controls
        src="3spk/enh/tasnet-3.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
  </tr>
</table>
<p>
    <img src="3spk/enh/grnn.png" width="305" height="125" />
<img src="3spk/enh/grnn-2.png" width="305" height="125" />
    <img src="3spk/enh/grnn-3.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>
      <td width="305">MIMO Generalized RNN for speaker1
      <audio
        controls
        src="3spk/enh/grnn.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305">MIMO Generalized RNN for speaker2
      <audio
        controls
        src="3spk/enh/grnn-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305">MIMO Generalized RNN for speaker3
      <audio
        controls
        src="3spk/enh/grnn-3.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
  </tr>
</table>
<p>
    <img src="3spk/enh/sarnn.png" width="305" height="125" />
<img src="3spk/enh/sarnn-2.png" width="305" height="125" />
    <img src="3spk/enh/sarnn-3.png" width="305" height="125" />
</p>
<table width="915" border="1">
  <tr>
      <td width="305"><strong>MIMO RNN+temporal-spatial SA beamformer for speaker1 </strong>
      <audio
        controls
        src="3spk/enh/temporal spatial sa-rnn.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305"><strong>MIMO RNN+temporal-spatial SA beamformer for speaker2 </strong>
      <audio
        controls
        src="3spk/enh/temporal spatial sa-rnn-2.wav">
            Your browser does not support the
            <code>audio</code> element.
    </audio>
  </td>
      <td width="305">
            <strong>MIMO RNN+temporal-spatial SA beamformer for speaker3 </strong>
            <audio
        controls
        src="3spk/enh/temporal spatial sa-rnn-3.wav">
            Your browser does not support the
            <code>audio</code> element.
            </audio>
        </td>
  </tr>
</table>
<p>&nbsp;</p>


<p><strong>Real-world scenario: far-field recording and testing:</strong></p>
<p><img src="camera_and_mic.png" width="600" height="180" /></p>
<p>Real-world recording hardware device: 15-element non-uniform linear microphone array and 180 degree wide-angle camera</p>
<p><img src="DOA_estimation.png" width="1000" height="260" /></p>
<p>For the real-world videos, the 180-degree wide-angle camera is calibrated and synchronized with the 15-channel mic array. We estimate the rough DOA of the target speaker according to the location of the target speaker in the whole camera view [4]. Face detection is applied to track the target speaker's DOA. </p>
    
<p><strong>Demo 3: Real-world far-field recording and testing 1:</strong></p>
<p>
  <video src="video/real_world_demo1_mixture.mp4" width="340" height="273" controls preload></video>
  <video src="video/mvdr11.mp4" width="340" height="273" controls preload></video>
<video src="video/mvdr22.mp4" width="340" height="273" controls preload></video>
    <video src="video/tasnet11.mp4" width="340" height="273" controls preload></video>
    <video src="video/tasnet22.mp4" width="340" height="273" controls preload></video>
    <video src="video/sarnn11.mp4" width="340" height="273" controls preload></video>
    <video src="video/sarnn22.mp4" width="340" height="273" controls preload></video>
</p>
<table width="1020" border="1">
  <tr>
    <td width="340">Real-world scenario: far-field <strong>two-speaker mixture</strong> recorded by the camera and microphone array</td>
    <td width="340">Real-world scenario: <strong>separated male voice</strong> by our previously reported MIMO MVDR method [3]</td>
             <td width="340">Real-world scenario: <strong>separated female voice</strong> by our previously reported MIMO MVDR method [3] </td>
      </tr>
    <tr>
        <td width="340">Real-world scenario: <strong>separated male voice</strong> by our previously reported MIMO Conv-TasNet method [3] </td>
             <td width="340">Real-world scenario: <strong>separated female voice</strong> by our previously reported MIMO Conv-TasNet method [3] </td>
      <td width="340">Real-world scenario: <strong>separated male voice</strong> by the <strong>proposed SA-RNN method</strong> </td>
    </tr>
    <tr>
         <td width="340">Real-world scenario: <strong>separated female voice</strong> by the <strong>proposed SA-RNN method</strong> </td>
  </tr>
</table>
  <p><strong>Demo 4: Real-world far-field recording and testing 2:</strong></p>
<p>
  <video src="video/real_world_demo2_mixture.mp4" width="340" height="273" controls preload></video>
  <video src="video/mvdrdemo2-1.mp4" width="340" height="273" controls preload></video>
<video src="video/mvdrdemo2-2.mp4" width="340" height="273" controls preload></video>
    <video src="video/tasnetdemo2-1.mp4" width="340" height="273" controls preload></video>
    <video src="video/tasnetdemo2-2.mp4" width="340" height="273" controls preload></video>
    <video src="video/sarnndemo2-1.mp4" width="340" height="273" controls preload></video>
    <video src="video/sarnndemo2-2.mp4" width="340" height="273" controls preload></video>
</p>
<table width="1020" border="1">
  <tr>
    <td width="340">Real-world scenario: far-field <strong>two-speaker mixture</strong> recorded by the camera and microphone array</td>
    <td width="340">Real-world scenario: <strong>separated male voice</strong> by our previously reported MIMO MVDR method [3]</td>
             <td width="340">Real-world scenario: <strong>separated female voice</strong> by our previously reported MIMO MVDR method [3] </td>
      </tr>
    <tr>
        <td width="340">Real-world scenario: <strong>separated male voice</strong> by our previously reported MIMO Conv-TasNet method [3] </td>
             <td width="340">Real-world scenario: <strong>separated female voice</strong> by our previously reported MIMO Conv-TasNet method [3] </td>
      <td width="340">Real-world scenario: <strong>separated male voice</strong> by the <strong>proposed SA-RNN method</strong> </td>
    </tr>
    <tr>
         <td width="340">Real-world scenario: <strong>separated female voice</strong> by the <strong>proposed SA-RNN method</strong> </td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>References: </strong></p>
<p>[1] Du, Jun, et al. "Robust speech recognition with speech enhanced deep neural networks." Interspeech2014 </p>
<p>[2] Xiao, Xiong, et al. "On time-frequency mask estimation for MVDR beamforming with application in robust speech recognition." ICASSP2017 </p>
<p>[3] Xu, Yong, et al. "Neural Spatio-Temporal Beamformer for Target Speech Separation." accepted to Interspeech2020.</p>  
<p>[4] Tan, Ke, et al. "Audio-visual speech separation and dereverberation with a two-stage multimodal network." IEEE Journal of Selected Topics in Signal Processing (2020).</p>
<p>[5] Luo, Yi, and Nima Mesgarani. "Conv-tasnet: Surpassing ideal time–frequency magnitude masking for speech separation." IEEE/ACM transactions on audio, speech, and language processing 27.8 (2019): 1256-1266.</p>
<p>[6] Gu R, Zhang S X, Xu Y, et al. Multi-modal multi-channel target speech separation[J]. IEEE Journal of Selected Topics in Signal Processing, 2020, 14(3): 530-541.</p>
<p>[7] Zhang, Zhuohuang, et al. "ADL-MVDR: All deep learning MVDR beamformer for target speech separation." arXiv preprint arXiv:2008.06994 (2020).</p>
<p>[8] Xu, Yong, et al. "Generalized RNN beamformer for target speech separation." arXiv preprint arXiv:2101.01280 (2021).</p>
<p>[9] Tencent ASR: https://ai.qq.com/product/aaiasr.shtml.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
